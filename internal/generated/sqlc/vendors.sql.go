// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: vendors.sql

package sqlc

import (
	"context"
	"database/sql"

	"github.com/google/uuid"
)

const createVendor = `-- name: CreateVendor :one



INSERT INTO vendors (
  id,
  company_name
) VALUES (
  $1, $2
)
RETURNING id, company_name, created_at, updated_at
`

type CreateVendorParams struct {
	ID          uuid.UUID
	CompanyName string
}

// -----------------------------------------------------------------------------------------------------------------------------
// MUTATION
// -----------------------------------------------------------------------------------------------------------------------------
// If you want to provide your own UUID occasionally
func (q *Queries) CreateVendor(ctx context.Context, arg CreateVendorParams) (Vendor, error) {
	row := q.db.QueryRowContext(ctx, createVendor, arg.ID, arg.CompanyName)
	var i Vendor
	err := row.Scan(
		&i.ID,
		&i.CompanyName,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const createVendorContacts = `-- name: CreateVendorContacts :one
INSERT INTO vendor_contacts (
  id,
  vendor_id,
  contact_person,
  mobile_no,
  email_id
) VALUES (
  $1, $2, $3, $4, $5
)
RETURNING id, vendor_id, contact_person, mobile_no, email_id, created_at, updated_at
`

type CreateVendorContactsParams struct {
	ID            uuid.UUID
	VendorID      uuid.UUID
	ContactPerson string
	MobileNo      string
	EmailID       string
}

func (q *Queries) CreateVendorContacts(ctx context.Context, arg CreateVendorContactsParams) (VendorContact, error) {
	row := q.db.QueryRowContext(ctx, createVendorContacts,
		arg.ID,
		arg.VendorID,
		arg.ContactPerson,
		arg.MobileNo,
		arg.EmailID,
	)
	var i VendorContact
	err := row.Scan(
		&i.ID,
		&i.VendorID,
		&i.ContactPerson,
		&i.MobileNo,
		&i.EmailID,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteVendorByID = `-- name: DeleteVendorByID :exec
DELETE FROM vendors
WHERE id = $1
`

func (q *Queries) DeleteVendorByID(ctx context.Context, id uuid.UUID) error {
	_, err := q.db.ExecContext(ctx, deleteVendorByID, id)
	return err
}

const deleteVendorContactsByID = `-- name: DeleteVendorContactsByID :exec
DELETE FROM vendor_contacts
WHERE vendor_id=$1
`

func (q *Queries) DeleteVendorContactsByID(ctx context.Context, vendorID uuid.UUID) error {
	_, err := q.db.ExecContext(ctx, deleteVendorContactsByID, vendorID)
	return err
}

const deleteVendorsByCompanyName = `-- name: DeleteVendorsByCompanyName :exec
DELETE FROM vendors
WHERE company_name ILIKE '%' || $1 || '%'
`

func (q *Queries) DeleteVendorsByCompanyName(ctx context.Context, dollar_1 sql.NullString) error {
	_, err := q.db.ExecContext(ctx, deleteVendorsByCompanyName, dollar_1)
	return err
}

const getVendorByCompanyName = `-- name: GetVendorByCompanyName :one
SELECT id, company_name, created_at, updated_at
FROM vendors
WHERE company_name=$1
`

func (q *Queries) GetVendorByCompanyName(ctx context.Context, companyName string) (Vendor, error) {
	row := q.db.QueryRowContext(ctx, getVendorByCompanyName, companyName)
	var i Vendor
	err := row.Scan(
		&i.ID,
		&i.CompanyName,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getVendorById = `-- name: GetVendorById :one

SELECT id, company_name, created_at, updated_at
FROM vendors
WHERE id = $1
`

// -----------------------------------------------------------------------------------------------------------------------------
// QUERY
// -----------------------------------------------------------------------------------------------------------------------------
func (q *Queries) GetVendorById(ctx context.Context, id uuid.UUID) (Vendor, error) {
	row := q.db.QueryRowContext(ctx, getVendorById, id)
	var i Vendor
	err := row.Scan(
		&i.ID,
		&i.CompanyName,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getVendorsByCompanyName = `-- name: GetVendorsByCompanyName :many

SELECT 
  vndrs.id,
  vndrs.company_name,
  vndr_cnts.contact_person,
  vndr_cnts.mobile_no,
  vndr_cnts.email_id
FROM vendor_contacts AS vndr_cnts
LEFT JOIN vendors AS vndrs ON vndrs.id = vndr_cnts.vendor_id
WHERE 
  NULLIF($1, '') IS NULL 
  OR LOWER(vndrs.company_name) ILIKE '%' || LOWER($1) || '%'
ORDER BY vndrs.company_name ASC
`

type GetVendorsByCompanyNameRow struct {
	ID            uuid.NullUUID
	CompanyName   sql.NullString
	ContactPerson string
	MobileNo      string
	EmailID       string
}

// -- name: GetVendorsByCompanyName :many
// SELECT *
// FROM vendors
// WHERE NULLIF($1,‚Äù) IS NULL OR company_name ILIKE '%' || LOWER($1) || '%'
// ORDER BY company_name ASC;
func (q *Queries) GetVendorsByCompanyName(ctx context.Context, dollar_1 interface{}) ([]GetVendorsByCompanyNameRow, error) {
	rows, err := q.db.QueryContext(ctx, getVendorsByCompanyName, dollar_1)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetVendorsByCompanyNameRow
	for rows.Next() {
		var i GetVendorsByCompanyNameRow
		if err := rows.Scan(
			&i.ID,
			&i.CompanyName,
			&i.ContactPerson,
			&i.MobileNo,
			&i.EmailID,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateVendorByID = `-- name: UpdateVendorByID :one
UPDATE vendors AS v
SET
  company_name   = COALESCE($1, v.company_name),
  updated_at     = now()
WHERE v.id = $2
RETURNING id, company_name, created_at, updated_at
`

type UpdateVendorByIDParams struct {
	CompanyName sql.NullString
	ID          uuid.UUID
}

func (q *Queries) UpdateVendorByID(ctx context.Context, arg UpdateVendorByIDParams) (Vendor, error) {
	row := q.db.QueryRowContext(ctx, updateVendorByID, arg.CompanyName, arg.ID)
	var i Vendor
	err := row.Scan(
		&i.ID,
		&i.CompanyName,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
